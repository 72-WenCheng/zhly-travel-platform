# 第三方登录配置说明

## 已实现功能

### 1. 手机号登录注册 ✅
- ✅ 支持各地区手机号格式验证（中国、香港、台湾、美国、英国、日本、韩国等20+个地区）
- ✅ 手机号登录接口：`POST /api/auth/login/phone`
- ✅ 手机号注册接口：`POST /api/auth/register/phone`
- ✅ 发送手机验证码接口：`POST /api/auth/send-phone-captcha`

**使用说明：**
```json
// 发送验证码
POST /api/auth/send-phone-captcha
{
  "phone": "13800138000"
}

// 手机号注册
POST /api/auth/register/phone
{
  "phone": "13800138000",
  "captcha": "123456",
  "password": "password123",
  "inviteCode": "optional"
}

// 手机号登录
POST /api/auth/login/phone
{
  "phone": "13800138000",
  "captcha": "123456",
  "loginType": "user"
}
```

**注意：** 目前手机验证码是模拟发送（在控制台打印），需要集成短信服务才能发送真实验证码。

### 2. 微信登录 ⚠️（需要配置）
- ⚠️ 接口已创建：`POST /api/auth/login/wechat`
- ⚠️ 需要配置微信开放平台信息

**配置步骤：**
1. 访问 [微信开放平台](https://open.weixin.qq.com/)
2. 创建网站应用，获取 AppID 和 AppSecret
3. 在 `application.yml` 中添加配置：
```yaml
wechat:
  appid: your_wechat_appid
  secret: your_wechat_secret
  redirect_uri: http://your-domain.com/auth/wechat/callback
```

### 3. QQ登录 ⚠️（需要配置）
- ⚠️ 接口已创建：`POST /api/auth/login/qq`
- ⚠️ 需要配置QQ互联信息

**配置步骤：**
1. 访问 [QQ互联](https://connect.qq.com/)
2. 创建应用，获取 AppID 和 AppKey
3. 在 `application.yml` 中添加配置：
```yaml
qq:
  appid: your_qq_appid
  appkey: your_qq_appkey
  redirect_uri: http://your-domain.com/auth/qq/callback
```

## 数据库字段要求

### 需要添加的字段（如果还没有）

在 `sys_user` 表中添加以下字段：

```sql
-- 微信相关
ALTER TABLE sys_user ADD COLUMN wechat_openid VARCHAR(100) COMMENT '微信OpenID';
ALTER TABLE sys_user ADD COLUMN wechat_unionid VARCHAR(100) COMMENT '微信UnionID';

-- QQ相关
ALTER TABLE sys_user ADD COLUMN qq_openid VARCHAR(100) COMMENT 'QQ OpenID';
ALTER TABLE sys_user ADD COLUMN qq_unionid VARCHAR(100) COMMENT 'QQ UnionID';

-- 登录方式标识
ALTER TABLE sys_user ADD COLUMN login_type VARCHAR(20) COMMENT '登录方式：phone/wechat/qq/email';
```

## 短信服务集成（可选）

目前手机验证码是模拟发送，如需发送真实验证码，需要集成短信服务：

### 推荐服务商
1. **阿里云短信服务**
2. **腾讯云短信服务**
3. **华为云短信服务**

### 集成示例（阿里云）
```java
// 在 UserServiceImpl.sendPhoneCaptcha 方法中
// 替换模拟发送部分为实际短信发送代码
```

## 前端集成说明

### 1. 手机号登录/注册
- 添加手机号输入框
- 添加发送验证码按钮
- 添加验证码输入框
- 调用对应的API接口

### 2. 微信登录
- 添加"微信登录"按钮
- 点击后跳转到微信授权页面
- 授权后回调到 `/auth/wechat/callback`
- 使用返回的 code 调用 `/api/auth/login/wechat`

### 3. QQ登录
- 添加"QQ登录"按钮
- 点击后跳转到QQ授权页面
- 授权后回调到 `/auth/qq/callback`
- 使用返回的 code 调用 `/api/auth/login/qq`

## 支持的手机号格式

### 已支持地区
- 中国大陆：`1[3-9]xxxxxxxxx`
- 中国香港：`(5|6|9)xxxxxxx`
- 中国澳门：`6xxxxxxx`
- 中国台湾：`09xxxxxxxx`
- 美国/加拿大：`+1xxxxxxxxxx`
- 英国：`+44xxxxxxxxxx`
- 日本：`+81xxxxxxxxxx`
- 韩国：`+82xxxxxxxxxx`
- 新加坡：`+65xxxxxxxxx`
- 马来西亚：`+60xxxxxxxxx`
- 泰国：`+66xxxxxxxxx`
- 印度：`+91xxxxxxxxxx`
- 澳大利亚：`+61xxxxxxxxx`
- 德国：`+49xxxxxxxxxx`
- 法国：`+33xxxxxxxxx`
- 意大利：`+39xxxxxxxxx`
- 西班牙：`+34xxxxxxxxx`
- 俄罗斯：`+7xxxxxxxxxx`
- 巴西：`+55xxxxxxxxxx`
- 墨西哥：`+52xxxxxxxxxx`
- 其他：支持通用国际格式 `+国家代码+号码`

## 注意事项

1. **手机验证码**：目前是模拟发送，生产环境需要集成短信服务
2. **微信/QQ登录**：需要完成OAuth流程实现，目前只是接口框架
3. **安全性**：建议添加频率限制，防止验证码被恶意刷取
4. **用户体验**：建议添加图形验证码，防止机器人攻击


